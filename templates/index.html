<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contract-Based Trading Simulator</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
</head>

<body class="g-sidenav-show bg-gray-100">
    <div class="container-fluid py-4 d-flex">
        <!-- Left Container for Form -->
        <div class="left-container" style="flex: 1 1 30%; max-width: 30%; padding-right: 20px;">
            <div class="card mb-4">
                <div class="card-header pb-0">
                    <h1 class="text-center">Contract-Based Trading Simulator</h1>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <!-- Form Fields -->
                        <div class="mb-3">
                            <label for="contracts" class="form-label">Number of Contracts</label>
                            <select id="contracts" name="contracts" class="form-control">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                        </div>
                        <!-- Other Form Fields... -->
                        <button type="submit" class="btn btn-primary">Run Simulation</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Right Container for Results -->
        <div class="right-container" style="flex: 1 1 70%; max-width: 70%;">
            <!-- Simulation Results -->
            {% if df_combined_html %}
            <div class="card mt-4">
                <div class="card-header pb-0">
                    <h2 class="text-center">Simulation Results</h2>
                </div>
                <div class="card-body">
                    <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                        {{ df_combined_html|safe }}
                    </div>
                    <p class="text-muted">Average Cumulative Profits: ${{ avg_profit }}</p>
                    <p class="text-muted">Maximum Drawdown: ${{ max_drawdown }}</p>
                    <p class="text-muted">Sharpe Ratio: {{ sharpe_ratio }}</p>
                </div>
            </div>
            {% endif %}

            <!-- Cumulative Profit Chart -->
            {% if graph_image %}
            <div class="card mt-4">
                <div class="card-header pb-0">
                    <h2 class="text-center">Cumulative Profit Chart</h2>
                </div>
                <div class="card-body text-center">
                    <img src="data:image/png;base64,{{ graph_image }}" class="img-fluid" alt="Cumulative Profit Chart">
                </div>
            </div>
            {% endif %}

            <!-- Download CSV -->
            {% if df_combined_html %}
            <div class="card mt-4">
                <div class="card-body text-center">
                    <form method="POST" action="/download">
                        <input type="hidden" name="csv_data" value="{{ df_combined_html }}">
                        <button type="submit" class="btn btn-secondary">Download as CSV</button>
                    </form>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</body>

</html>
